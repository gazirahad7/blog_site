<div class="container">
  <form
    action="/submit"
    method="POST"
    class="mt-3"
    enctype="multipart/form-data"
  >
    <div class="mb-3">
      <label>Image Upload</label>
      <div id="img-preview-div"></div>

      <input
        type="file"
        id="img-upload"
        class="form-control mt-2"
        name="files"
        multiple
      />
    </div>
    <div class="form-group">
      <label>Title</label>
      <input
        type="text"
        class="form-control"
        name="postTitle"
        placeholder="Enter your title....."
      />
    </div>

    <div class="form-group">
      <label>Category</label>
      <select class="custom-select" name="category">
        <% allCategories.map(category =>{ %>
        <option value="<%= category.id %>"><%= category.name %></option>
        <% }) %>
      </select>
    </div>

    <div class="form-group">
      <label for="exampleFormControlTextarea1">Description:</label>
      <textarea
        class="form-control"
        rows="3"
        id="exampleFormControlTextarea1"
        name="postBody"
      ></textarea>
    </div>

    <button type="submit" class="btn btn-primary">Submit</button>
  </form>
</div>

<script>
  document.getElementById("img-upload").addEventListener("change", (e) => {
    console.log("selected image", e.target.files.length);
    const imgPreview = document.getElementById("img-preview-div");
    let i = 0;
    while (i < e.target.files.length) {
      const imgTag = document.createElement("img");
      imgTag.src = window.URL.createObjectURL(e.target.files[i]);
      imgTag.classList.add("preview-img");
      imgTag.classList.add("img-class");

      imgPreview.append(imgTag);
      i++;
    }
  });
</script>
